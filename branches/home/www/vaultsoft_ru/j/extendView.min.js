;(function(){var extendView=function(paramTable){var self=this;var params=paramTable||{};this.trigger=params.trigger||$("<div id = triggerView></div>").prependTo("body").get(0);this.regions=params.regions||"#sidebar-left, #sidebar-right";this.contentClasses=params.classes||"narrow-left narrow-right";this.content=params.content||"#content";this.cookieName=params.cookieName||"extendViewState";this.initialState=params.initialState||$.cookie(this.cookieName)||"Shown";this.arrowLeft="&#x25C0;";this.arrowRight="&#x25B6;";if("undefined"==typeof this.actionTransitionFunctions[this.initialState]){this.initialState="Shown";}
this.currentState=this.initialState;this.currentState=this.doActionTransition(this.initialState,"restore");$(this.regions).click(function(e){self.handleEvent(e);}).mousemove(function(e){self.handleEvent(e);}).mouseout(function(e){self.handleEvent(e);}).find("input, a").focus(function(e){self.handleEvent(e);}).blur(function(e){self.handleEvent(e);});$(this.trigger).removeClass("hidden").click(function(e){self.handleEvent(e);e.target.inn=false;}).mouseover(function(e){e.target.inn=false;if(self.currentState=="Hidden"){e.target.inn=true;}}).mouseout(function(e){e.target.inn=false;}).mousemove(function(e){if(self.currentState!="Hidden"){self.handleEvent(e);}else{if(e.target.inn){self.handleEvent(e);}}
e.target.inn=false;});};extendView.prototype={currentState:null,trace:function(obj){if("undefined"!=typeof(console)){console.log(obj);}},actionTransitionFunctions:{Shown:{restore:function(){$(this.regions).removeClass("peep half hidden-by-pos");$(this.content).removeClass("peep half").addClass(this.contentClasses);$(this.trigger).html(this.arrowLeft);this.cancelTimer();this.startTimer(this.timeoutShown*1000);return this.currentState;},focus:function(e){this.cancelTimer();$(this.regions).removeClass("half").removeClass("hidden-by-pos");$(this.content).removeClass("half").addClass(this.contentClasses);$(this.trigger).html(this.arrowLeft);return"Stop";},mousemove:function(e){this.cancelTimer();this.startTimer(this.timeoutShown*1000);return"Shown";},click:function(e){if(e&&e.target===this.trigger){if(this.currentState=="Shown"){this.cancelTimer();return this.doActionTransition("Half","timeout",e);}}
return this.doActionTransition("Shown","mousemove",e);},timeout:function(e){$(this.regions).addClass("half");$("#content").addClass("half");$(this.trigger).html(this.arrowRight);this.startTimer(this.timeoutHalfShown*1000);return"Half";}},Stop:{restore:function(){this.cancelTimer();$(this.regions).removeClass("peep half hidden-by-pos");$(this.content).removeClass("peep half").addClass(this.contentClasses);$(this.regions).focus();return this.currentState;},blur:function(e){return this.doActionTransition("Shown","mousemove",e);}},Half:{restore:function(){$(this.regions).removeClass("peep hidden-by-pos").addClass("half");$(this.content).removeClass("peep").addClass("half");this.cancelTimer();this.startTimer(this.timeoutHalfShown*1000);$(this.trigger).html(this.arrowRight);return this.currentState;},focus:function(e){return this.doActionTransition("Shown","focus",e);},mousemove:function(e){return this.doActionTransition("Half","click",e);},click:function(e){this.cancelTimer();$(this.regions).removeClass("half");$("#content").removeClass("half");$(this.trigger).html(this.arrowLeft);return this.doActionTransition("Shown","click",e);},timeout:function(e){$(this.regions).removeClass("half").addClass("hidden-by-pos");$(this.content).removeClass("half "+this.contentClasses);$(this.trigger).html(this.arrowRight);this.cancelTimer();return"Hidden";}},Hidden:{restore:function(){$(this.regions).removeClass("peep half").addClass("hidden-by-pos");$(this.content).removeClass("peep half "+this.contentClasses);this.cancelTimer();$(this.trigger).html(this.arrowRight);return this.currentState;},focus:function(e){return this.doActionTransition("Shown","focus",e);},mousemove:function(e){if(!this.currentTimer){$(this.regions).addClass("peep");$(this.content).addClass("peep");this.startTimer(this.timeoutPause*1000);}},mouseout:function(e){$(this.regions).removeClass("peep");$(this.content).removeClass("peep");this.cancelTimer();},click:function(e){this.doActionTransition("Hidden","mouseout",e);$(this.regions).removeClass("hidden-by-pos");$(this.content).addClass(this.contentClasses);return this.doActionTransition("Half","click",e);},timeout:function(e){return this.doActionTransition("Hidden","click",e);}}},timeoutShown:5,timeoutHalfShown:3,timeoutPause:1,handleEvent:function(event){var actionTransitionFunction=this.actionTransitionFunctions[this.currentState][event.type];if(!actionTransitionFunction){return true;}
var nextState=actionTransitionFunction.call(this,event)||this.currentState;if(!this.actionTransitionFunctions[nextState]){nextState=this.undefinedState(event,nextState);}
this.currentState=nextState;$.cookie(this.cookieName,null);$.cookie(this.cookieName,this.currentState);},unexpectedEvent:function(event){this.cancelTimer();return this.initialState;},undefinedState:function(event,state){this.cancelTimer();return this.initialState;},doActionTransition:function(anotherState,anotherEventType,event){return this.actionTransitionFunctions[anotherState][anotherEventType].call(this,event);},startTimer:function(timeout){var self=this;this.currentTimer=setTimeout(function(){self.handleEvent({type:"timeout"});},timeout);},cancelTimer:function(){if(this.currentTimer){clearTimeout(this.currentTimer);}
this.currentTimer=null;}};$(document).ready(function(){var sideBars=""+($("#content").hasClass("with-sidebar-left")?"with-sidebar-left ":"")+
($("#content").hasClass("with-sidebar-right")?"with-sidebar-right":"");if(sideBars.length){var exv=new extendView({trigger:$("#triggerView").get(0),classes:sideBars});};});})
();